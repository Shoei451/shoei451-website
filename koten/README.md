# 古典文法エディタ - Classical Japanese Grammar Analyzer

古典の品詞分解を作成・管理・閲覧できる学習アプリです。

## 🎯 主な機能

### 編集モード
- **テキスト入力**: `/`で単語を区切って入力
- **品詞分解**: 各単語に品詞・活用・用法を設定
- **補助動詞マーク**: 補助動詞を視覚的に区別
- **敬語設定**: 尊敬語・謙譲語・丁寧語を分類、敬意の向きも記録
- **登場人物管理**: 作品の登場人物を登録
- **係り結び設定**: 係助詞と結びの語をペアリング
- **Supabase自動保存**: データベースに自動保存

### 閲覧モード
- **色分け表示**: 品詞ごとに淡い色で区別
- **敬語アイコン**: 語の上に尊・謙・丁のアイコン表示
- **補助動詞マーク**: 二重下線で表示
- **単語タップ**: 詳細情報を吹き出しで表示
- **係り結び矢印**: 係助詞と結びの語を矢印で視覚化
- **行間広め**: 矢印用のスペースを確保

## 📦 セットアップ手順

### 1. Supabaseプロジェクト作成

1. [Supabase](https://supabase.com)にアクセス
2. 新しいプロジェクトを作成
3. SQL Editorを開く
4. `classical-grammar-schema.sql`の内容をコピー＆実行

### 2. ファイル配置

あなたのウェブサイトのディレクトリ構造：

```
your-website/
├── classical-grammar/
│   ├── index.html
│   ├── css/
│   │   └── classical-grammar.css
│   └── js/
│       ├── classical-data.js
│       ├── classical-editor.js
│       └── classical-viewer.js
├── css/
│   └── common.css (既存)
├── js/
│   └── theme-toggle.js (既存)
└── images/
    └── favicon.png (既存)
```

### 3. Supabase認証情報の設定

`js/classical-data.js`の5-6行目を編集：

```javascript
const SUPABASE_URL = 'あなたのSupabase URL';
const SUPABASE_KEY = 'あなたのSupabase anon key';
```

これらの情報は、Supabaseプロジェクトの「Project Settings」→「API」で確認できます。

### 4. アクセス

ブラウザで `your-website/classical-grammar/index.html` を開く

## 🎨 使い方

### 基本的なワークフロー

1. **編集モードを選択**
   
2. **作品情報を入力**
   - 作品名、作者、時代、ジャンルを入力

3. **登場人物を追加**
   - 人物名と身分を入力して追加

4. **本文を入力**
   - `/`で単語を区切って入力
   - 例: `春/は/あけぼの/。/やうやう/白く/なり/ゆく/...`

5. **品詞分解開始**
   - 単語一覧が表示される

6. **各単語を編集**
   - 単語をクリックして詳細情報を入力
   - 品詞、活用、敬語などを設定

7. **保存**
   - 「💾 保存」ボタンでSupabaseに保存

8. **閲覧モードで確認**
   - 「👁️ 閲覧モード」で完成形を表示

## 🎯 品詞カラー

- **動詞**: 淡い青
- **形容詞/形容動詞**: 淡い緑
- **助動詞**: 淡い黄
- **助詞**: 淡いピンク
- **名詞/代名詞**: 淡いグレー

## 📊 Supabaseテーブル構造

- `classical_texts`: 作品情報
- `characters`: 登場人物
- `text_passages`: 本文
- `word_analyses`: 単語解析（品詞分解）
- `kakari_musubi`: 係り結び

詳細は `classical-grammar-schema.sql` を参照してください。

## 🔧 カスタマイズ

### 色の変更

`css/classical-grammar.css`の6-15行目（`:root`セクション）で色を調整できます。

### プリセット単語の追加

`js/classical-data.js`の35-60行目の`commonWordPresets`に、よく使う単語のプリセットを追加できます。

## 📝 今後の改善案

- [ ] 作品一覧画面の追加
- [ ] 複数段落対応
- [ ] PDFエクスポート
- [ ] 現代語訳フィールドの追加（オプション）
- [ ] 助詞の種類（格助詞、接続助詞等）の詳細分類
- [ ] 係り結びの自動検出機能

## 🐛 トラブルシューティング

### データが保存されない

1. ブラウザのコンソール（F12）でエラーを確認
2. Supabase認証情報が正しいか確認
3. SupabaseのRow Level Security設定を確認

### 矢印が表示されない

1. 係助詞に正しく「用法」を設定しているか確認（ぞ、なむ、や、か、こそ）
2. 結びの語が適切な活用形（連体形または已然形）になっているか確認

## 📄 ライセンス

このプロジェクトは学習目的で作成されています。自由に使用・改変してください。

---

作成: 2025年1月
